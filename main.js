(()=>{"use strict";const e=()=>{const e=[],t=[];for(let t=0;t<10;t+=1)e[t]=new Array(10).fill({});return{getTile:(t,n)=>e[t][n],placeShip:({row:n,col:i,length:l,isVertical:r})=>{const o=(e=>{const t=new Array(e).fill(!1);return{getLength:()=>e,isSunk:()=>t.every((e=>e)),hit:e=>{t[e]=!0}}})(l);if(t.push(o),r)for(let t=0;t<l;t+=1)e[n+t][i]={ship:o,pos:t};else for(let t=0;t<l;t+=1)e[n][i+t]={ship:o,pos:t}},receiveAttack:(t,n)=>{const i=e[t][n];return i.ship?(i.hit=!0,i.ship.hit(i.pos),!0):(e[t][n]={miss:!0},!1)},isAllSunk:()=>t.every((e=>e.isSunk())),isValidTarget:(t,n)=>{if(t<0||t>=10||n<0||n>=10)return!1;const i=e[t][n];return!(i.miss||i.hit)},getWidth:()=>e[0].length,getHeight:()=>e.length}},t=()=>{const e=[];let t=0;const n=[[0,-1],[-1,0],[0,1],[1,0]],i=e=>Math.floor(e*Math.random()),l=()=>{const e=i(10),t=i(10);return Promise.resolve([e,t])};return{takeTurn:async function(n,i){let l,r,o=!1;for(;!o;)[l,r]=await i(),o=n.isValidTarget(l,r);const s=n.receiveAttack(l,r);return s&&(e.push([l,r]),t=0),Promise.resolve({row:l,col:r,hit:s})},randomTarget:l,aiTarget:()=>{if(4===t&&(e.pop(),t=0),0===e.length)return l();let i,r;[i,r]=e[e.length-1];const o=n[t];return i+=o[0],r+=o[1],t+=1,Promise.resolve([i,r])}}};function n(e,t){let n,i;return e.hit||e.miss||e.ship&&t?e.miss?(i="cell-miss",n="."):e.hit&&e.ship.isSunk()?(i="cell-sunk",n="X"):e.hit?(i="cell-hit",n="x"):(i="cell-ship",n="T"):(i="cell-empty",n="O"),{symbol:n,category:i}}const i=function(e,t,i,l){const r=function(e,t=!1,i){const l=document.createElement("div"),r=document.createElement("table");l.appendChild(r);const o=e.getWidth(),s=e.getHeight();for(let l=0;l<s;l+=1){const s=document.createElement("tr");r.appendChild(s);for(let r=0;r<o;r+=1){const o=document.createElement("td");s.appendChild(o);const c=document.createElement("button");o.append(c);const a=n(e.getTile(l,r),t);c.className=a.category,c.innerText=a.symbol,!t&&i&&c.addEventListener("click",(()=>{i.emit("target-select",[l,r])}))}}return l}(t,i,l);e.firstChild?e.replaceChild(r,e.firstChild):e.appendChild(r)},l=function(e,t,n){const i=function(e,t){const n=document.createElement("p");return n.innerText=`${t} targeted [${e.row}, ${e.col}].`,n.className="log-event",e.hit&&(n.innerText+=" Hit!"),n}(t,n);e.appendChild(i)},r=function(e,t){const n=document.createElement("p");e.appendChild(n),n.className="log-event",n.innerText=`${t} Wins!`};function o(){const t=e();return t.placeShip({row:0,col:2,length:2,isVertical:!1}),t.placeShip({row:3,col:0,length:3,isVertical:!1}),t.placeShip({row:4,col:3,length:3,isVertical:!0}),t.placeShip({row:2,col:5,length:4,isVertical:!1}),t.placeShip({row:6,col:5,length:5,isVertical:!1}),t}const s=async function(){const e=t(),n=t(),s=o(),c=o(),a=(e=>{const t=e||{};return{subscribe:(e,n)=>((t[e]||(t[e]=[])).push(n),{unsubscribe:()=>{t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)}}),emit:(e,n)=>{(t[e]||[]).forEach((e=>{e(...n)}))}}})(),u=()=>function(e){let t;const n=new Promise((n=>{t=e.subscribe("target-select",((e,t)=>{n([e,t])}))}));return n.finally((()=>{t.unsubscribe()})),n}(a),h=document.getElementById("board1"),p=document.getElementById("board2"),d=document.getElementById("log");for(i(h,s,!0),i(p,c,!1,a);!s.isAllSunk();){i(h,s,!0);const t=await e.takeTurn(c,u);if(l(d,t,"Human"),c.isAllSunk())break;i(p,c,!1,a);const r=await n.takeTurn(s,n.aiTarget);l(d,r,"AI")}s.isAllSunk()?(i(h,s,!0),i(p,c,!0),r(d,"AI")):(i(p,c,!0),r(d,"Human"))};console.log("webpack compiled to main.js"),Promise.resolve("loaded").then((()=>{s()})),console.log("end of main.js")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LFNBS25DckIsRUFBTzNELFlBQ1QsTUFHRixFQUFzQjhFLEVBQVluQixHQUFRLEVBQU8vQixHQUdqRCxNQUFNcUQsUUFBZ0J4QixFQUFRMUMsU0FBUzJDLEVBQVFELEVBQVFyQyxVQUN2RCxFQUFxQjJELEVBQVNFLEVBQVMsTUFJckN2QixFQUFPMUQsYUFDVCxFQUFzQjRFLEVBQVlsQixHQUFRLEdBRTFDLEVBQXNCb0IsRUFBWW5CLEdBQVEsR0FDMUMsRUFBc0JvQixFQUFTLFFBRS9CLEVBQXNCRCxFQUFZbkIsR0FBUSxHQUMxQyxFQUFzQm9CLEVBQVMsV0U3R25DRyxRQUFRQyxJQUFJLCtCQUVRdEUsUUFBUUMsUUFBUSxVQUN4QnNFLE1BQUssS0FDZkMsT0FHRkgsUUFBUUMsSUFBSSxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2RyYXdCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVMb29wLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvbWVzc2VuZ2VyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hpcEZhY3RvcnkgPSAobGVuZ3RoKSA9PiB7XG4gIGNvbnN0IGhpdHMgPSBuZXcgQXJyYXkobGVuZ3RoKS5maWxsKGZhbHNlKTtcblxuICBjb25zdCBnZXRMZW5ndGggPSAoKSA9PiBsZW5ndGg7XG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IGhpdHMuZXZlcnkoKHZhbHVlKSA9PiB2YWx1ZSk7XG4gIGNvbnN0IGhpdCA9IChpbmRleCkgPT4ge1xuICAgIGhpdHNbaW5kZXhdID0gdHJ1ZTtcbiAgfTtcblxuICByZXR1cm4geyBnZXRMZW5ndGgsIGlzU3VuaywgaGl0IH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzaGlwRmFjdG9yeTtcbiIsImltcG9ydCBzaGlwRmFjdG9yeSBmcm9tICcuL3NoaXAnO1xuXG5jb25zdCBnYW1lYm9hcmRGYWN0b3J5ID0gKCkgPT4ge1xuICBjb25zdCBib2FyZFNpemUgPSAxMDtcbiAgY29uc3QgYm9hcmQgPSBbXTtcbiAgY29uc3Qgc2hpcHMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkU2l6ZTsgaSArPSAxKSB7XG4gICAgYm9hcmRbaV0gPSBuZXcgQXJyYXkoYm9hcmRTaXplKS5maWxsKHt9KTtcbiAgfVxuXG4gIGNvbnN0IGdldFRpbGUgPSAocm93LCBjb2wpID0+IGJvYXJkW3Jvd11bY29sXTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoe1xuICAgIHJvdywgY29sLCBsZW5ndGgsIGlzVmVydGljYWwsXG4gIH0pID0+IHtcbiAgICBjb25zdCBzaGlwID0gc2hpcEZhY3RvcnkobGVuZ3RoKTtcbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICAgIGlmIChpc1ZlcnRpY2FsKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGJvYXJkW3JvdyArIGldW2NvbF0gPSB7XG4gICAgICAgICAgc2hpcCxcbiAgICAgICAgICBwb3M6IGksXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYm9hcmRbcm93XVtjb2wgKyBpXSA9IHtcbiAgICAgICAgICBzaGlwLFxuICAgICAgICAgIHBvczogaSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChyb3csIGNvbCkgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBib2FyZFtyb3ddW2NvbF07XG4gICAgaWYgKGNlbGwuc2hpcCkge1xuICAgICAgY2VsbC5oaXQgPSB0cnVlO1xuICAgICAgY2VsbC5zaGlwLmhpdChjZWxsLnBvcyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8gY3JlYXRlIG5ldyBjZWxsIGJlY2F1c2UgYWxsIGVtcHR5IGNlbGxzIHJlZmVyZW5jZSBzYW1lIG9iamVjdFxuICAgIGJvYXJkW3Jvd11bY29sXSA9IHsgbWlzczogdHJ1ZSB9O1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBpc0FsbFN1bmsgPSAoKSA9PiBzaGlwcy5ldmVyeSgoc2hpcCkgPT4gc2hpcC5pc1N1bmsoKSk7XG5cbiAgY29uc3QgaXNWYWxpZFRhcmdldCA9IChyb3csIGNvbCkgPT4ge1xuICAgIGlmIChyb3cgPCAwIHx8IHJvdyA+PSBib2FyZFNpemUgfHwgY29sIDwgMCB8fCBjb2wgPj0gYm9hcmRTaXplKSB7IHJldHVybiBmYWxzZTsgfVxuICAgIGNvbnN0IGNlbGwgPSBib2FyZFtyb3ddW2NvbF07XG4gICAgcmV0dXJuICEoY2VsbC5taXNzIHx8IGNlbGwuaGl0KTtcbiAgfTtcblxuICBjb25zdCBnZXRXaWR0aCA9ICgpID0+IGJvYXJkWzBdLmxlbmd0aDtcbiAgY29uc3QgZ2V0SGVpZ2h0ID0gKCkgPT4gYm9hcmQubGVuZ3RoO1xuXG4gIHJldHVybiB7XG4gICAgZ2V0VGlsZSwgcGxhY2VTaGlwLCByZWNlaXZlQXR0YWNrLCBpc0FsbFN1bmssIGlzVmFsaWRUYXJnZXQsIGdldFdpZHRoLCBnZXRIZWlnaHQsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lYm9hcmRGYWN0b3J5O1xuIiwiY29uc3QgcGxheWVyRmFjdG9yeSA9ICgpID0+IHtcbiAgY29uc3QgYm9hcmRTaXplID0gMTA7XG4gIGNvbnN0IGhpdFN0YWNrID0gW107XG4gIGxldCBzZWFyY2hDb3VudCA9IDA7XG4gIGNvbnN0IHNlYXJjaE9mZnNldHMgPSBbWzAsIC0xXSwgWy0xLCAwXSwgWzAsIDFdLCBbMSwgMF1dO1xuXG4gIGNvbnN0IHRha2VUdXJuID0gYXN5bmMgZnVuY3Rpb24gdGFrZVR1cm4ob3RoZXJCb2FyZCwgdGFyZ2V0RnVuYykge1xuICAgIGxldCB2YWxpZFRhcmdldCA9IGZhbHNlO1xuICAgIGxldCByb3c7XG4gICAgbGV0IGNvbDtcbiAgICB3aGlsZSAoIXZhbGlkVGFyZ2V0KSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcFxuICAgICAgW3JvdywgY29sXSA9IGF3YWl0IHRhcmdldEZ1bmMoKTtcbiAgICAgIHZhbGlkVGFyZ2V0ID0gb3RoZXJCb2FyZC5pc1ZhbGlkVGFyZ2V0KHJvdywgY29sKTtcbiAgICB9XG5cbiAgICBjb25zdCBoaXQgPSBvdGhlckJvYXJkLnJlY2VpdmVBdHRhY2socm93LCBjb2wpO1xuICAgIGlmIChoaXQpIHtcbiAgICAgIGhpdFN0YWNrLnB1c2goW3JvdywgY29sXSk7XG4gICAgICBzZWFyY2hDb3VudCA9IDA7XG4gICAgfVxuICAgIC8vIGNvbnNvbGUubG9nKCd0YXJnZXRlZCcsIHJvdywgY29sKTtcblxuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoeyByb3csIGNvbCwgaGl0IH0pO1xuICB9O1xuXG4gIGNvbnN0IHJhbmRJbnQgPSAobnVtKSA9PiBNYXRoLmZsb29yKG51bSAqIE1hdGgucmFuZG9tKCkpO1xuXG4gIGNvbnN0IHJhbmRvbVRhcmdldCA9ICgpID0+IHtcbiAgICBjb25zdCByb3cgPSByYW5kSW50KGJvYXJkU2l6ZSk7XG4gICAgY29uc3QgY29sID0gcmFuZEludChib2FyZFNpemUpO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW3JvdywgY29sXSk7XG4gIH07XG5cbiAgY29uc3QgYWlUYXJnZXQgPSAoKSA9PiB7XG4gICAgaWYgKHNlYXJjaENvdW50ID09PSA0KSB7XG4gICAgICBoaXRTdGFjay5wb3AoKTtcbiAgICAgIHNlYXJjaENvdW50ID0gMDtcbiAgICB9XG4gICAgaWYgKGhpdFN0YWNrLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3QgcmFuZG9tUHJvbWlzZSA9IHJhbmRvbVRhcmdldCgpO1xuICAgICAgcmV0dXJuIHJhbmRvbVByb21pc2U7XG4gICAgfVxuICAgIGxldCByb3c7XG4gICAgbGV0IGNvbDtcbiAgICBbcm93LCBjb2xdID0gaGl0U3RhY2tbaGl0U3RhY2subGVuZ3RoIC0gMV07XG4gICAgY29uc3Qgb2Zmc2V0ID0gc2VhcmNoT2Zmc2V0c1tzZWFyY2hDb3VudF07XG4gICAgcm93ICs9IG9mZnNldFswXTtcbiAgICBjb2wgKz0gb2Zmc2V0WzFdO1xuICAgIHNlYXJjaENvdW50ICs9IDE7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcm93LCBjb2xdKTtcbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHRha2VUdXJuLCByYW5kb21UYXJnZXQsIGFpVGFyZ2V0LFxuICB9O1xufTtcblxuZXhwb3J0IGRlZmF1bHQgcGxheWVyRmFjdG9yeTtcbiIsIi8vIHByZXBhcmUgYW4gaHRtbCBlbGVtZW50IHRvIHJlcHJlc2VudCBhIDEweDEwIGJvYXJkXG5mdW5jdGlvbiBnZXRUaWxlR3JvdXAoY2VsbCwgaXNPd25Cb2FyZCkge1xuICBsZXQgc3ltYm9sO1xuICBsZXQgY2F0ZWdvcnk7XG4gIGlmICghY2VsbC5oaXQgJiYgIWNlbGwubWlzcyAmJiAoIWNlbGwuc2hpcCB8fCAhaXNPd25Cb2FyZCkpIHtcbiAgICAvLyBubyBzaG90IHlldCwgbm8gc2hpcCBvciBlbmVteSBzaGlwIHRoYXQgcmVtYWlucyBoaWRkZW5cbiAgICBjYXRlZ29yeSA9ICdjZWxsLWVtcHR5JztcbiAgICBzeW1ib2wgPSAnTyc7XG4gIH0gZWxzZSBpZiAoY2VsbC5taXNzKSB7XG4gICAgLy8gbWlzc2VkIHNob3RcbiAgICBjYXRlZ29yeSA9ICdjZWxsLW1pc3MnO1xuICAgIHN5bWJvbCA9ICcuJztcbiAgfSBlbHNlIGlmIChjZWxsLmhpdCAmJiBjZWxsLnNoaXAuaXNTdW5rKCkpIHtcbiAgICAvLyBoaXQgYW5kIHN1bmtcbiAgICBjYXRlZ29yeSA9ICdjZWxsLXN1bmsnO1xuICAgIHN5bWJvbCA9ICdYJztcbiAgfSBlbHNlIGlmIChjZWxsLmhpdCkge1xuICAgIC8vIG9ubHkgYSBoaXRcbiAgICBjYXRlZ29yeSA9ICdjZWxsLWhpdCc7XG4gICAgc3ltYm9sID0gJ3gnO1xuICB9IGVsc2Uge1xuICAgIC8vIGEgc2hpcCB0aGF0IGJlbG9uZ3MgdG8gdGhlIHBsYXllclxuICAgIGNhdGVnb3J5ID0gJ2NlbGwtc2hpcCc7XG4gICAgc3ltYm9sID0gJ1QnO1xuICB9XG4gIHJldHVybiB7IHN5bWJvbCwgY2F0ZWdvcnkgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQm9hcmRFbGVtKGJvYXJkLCBpc093bkJvYXJkID0gZmFsc2UsIHB1YnN1Yikge1xuICBjb25zdCBwYXJlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgY29uc3QgdGFibGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0YWJsZScpO1xuICBwYXJlbnQuYXBwZW5kQ2hpbGQodGFibGUpO1xuICBjb25zdCB3aWR0aCA9IGJvYXJkLmdldFdpZHRoKCk7XG4gIGNvbnN0IGhlaWdodCA9IGJvYXJkLmdldEhlaWdodCgpO1xuXG4gIGZvciAobGV0IHJvdyA9IDA7IHJvdyA8IGhlaWdodDsgcm93ICs9IDEpIHtcbiAgICBjb25zdCB0Um93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndHInKTtcbiAgICB0YWJsZS5hcHBlbmRDaGlsZCh0Um93KTtcbiAgICBmb3IgKGxldCBjb2wgPSAwOyBjb2wgPCB3aWR0aDsgY29sICs9IDEpIHtcbiAgICAgIGNvbnN0IHREaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZCcpO1xuICAgICAgdFJvdy5hcHBlbmRDaGlsZCh0RGl2KTtcbiAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgdERpdi5hcHBlbmQoYnV0dG9uKTtcbiAgICAgIGNvbnN0IGdyb3VwID0gZ2V0VGlsZUdyb3VwKGJvYXJkLmdldFRpbGUocm93LCBjb2wpLCBpc093bkJvYXJkKTtcbiAgICAgIGJ1dHRvbi5jbGFzc05hbWUgPSBncm91cC5jYXRlZ29yeTtcbiAgICAgIGJ1dHRvbi5pbm5lclRleHQgPSBncm91cC5zeW1ib2w7XG4gICAgICAvLyBhZGQgZXZlbnQgbGlzdGVuZXIgdG8gY2VsbCBmb3IgaW5wdXRzXG4gICAgICBpZiAoIWlzT3duQm9hcmQgJiYgcHVic3ViKSB7XG4gICAgICAgIGJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICBwdWJzdWIuZW1pdCgndGFyZ2V0LXNlbGVjdCcsIFtyb3csIGNvbF0pO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmVudDtcbn1cblxuZnVuY3Rpb24gZHJhd0JvYXJkKGNvbnRhaW5lciwgYm9hcmQsIGlzT3duQm9hcmQsIHB1YnN1Yikge1xuICBjb25zdCBib2FyZEVsZW0gPSBjcmVhdGVCb2FyZEVsZW0oYm9hcmQsIGlzT3duQm9hcmQsIHB1YnN1Yik7XG4gIGlmIChjb250YWluZXIuZmlyc3RDaGlsZCkgeyBjb250YWluZXIucmVwbGFjZUNoaWxkKGJvYXJkRWxlbSwgY29udGFpbmVyLmZpcnN0Q2hpbGQpOyB9IGVsc2UgeyBjb250YWluZXIuYXBwZW5kQ2hpbGQoYm9hcmRFbGVtKTsgfVxufVxuXG5mdW5jdGlvbiBjcmVhdGVFdmVudExvZ0VsZW0oYWN0aW9uLCBwbGF5ZXIpIHtcbiAgY29uc3QgbG9nRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgbG9nRWxlbS5pbm5lclRleHQgPSBgJHtwbGF5ZXJ9IHRhcmdldGVkIFske2FjdGlvbi5yb3d9LCAke2FjdGlvbi5jb2x9XS5gO1xuICBsb2dFbGVtLmNsYXNzTmFtZSA9ICdsb2ctZXZlbnQnO1xuXG4gIGlmIChhY3Rpb24uaGl0KSB7IGxvZ0VsZW0uaW5uZXJUZXh0ICs9ICcgSGl0ISc7IH1cblxuICByZXR1cm4gbG9nRWxlbTtcbn1cblxuZnVuY3Rpb24gbG9nRXZlbnQocGFyZW50LCBhY3Rpb24sIHBsYXllcikge1xuICBjb25zdCBlbGVtID0gY3JlYXRlRXZlbnRMb2dFbGVtKGFjdGlvbiwgcGxheWVyKTtcbiAgcGFyZW50LmFwcGVuZENoaWxkKGVsZW0pO1xufVxuXG5mdW5jdGlvbiBsb2dXaW5uZXIocGFyZW50LCBwbGF5ZXIpIHtcbiAgY29uc3QgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgcGFyZW50LmFwcGVuZENoaWxkKGVsZW0pO1xuICBlbGVtLmNsYXNzTmFtZSA9ICdsb2ctZXZlbnQnO1xuICBlbGVtLmlubmVyVGV4dCA9IGAke3BsYXllcn0gV2lucyFgO1xufVxuXG5leHBvcnQgZGVmYXVsdCB7IGRyYXdCb2FyZCwgbG9nRXZlbnQsIGxvZ1dpbm5lciB9O1xuIiwiaW1wb3J0IGdhbWVib2FyZEZhY3RvcnkgZnJvbSAnLi9nYW1lYm9hcmQnO1xuaW1wb3J0IHBsYXllckZhY3RvcnkgZnJvbSAnLi9wbGF5ZXInO1xuaW1wb3J0IGJvYXJkRHJhd2VyIGZyb20gJy4vZHJhd0JvYXJkJztcbmltcG9ydCBldmVudEVtaXR0ZXIgZnJvbSAnLi9tZXNzZW5nZXInO1xuXG5mdW5jdGlvbiBzdGF0aWNCb2FyZFNldHVwKCkge1xuICBjb25zdCBib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDAsIGNvbDogMiwgbGVuZ3RoOiAyLCBpc1ZlcnRpY2FsOiBmYWxzZSxcbiAgfSk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiAzLCBjb2w6IDAsIGxlbmd0aDogMywgaXNWZXJ0aWNhbDogZmFsc2UsXG4gIH0pO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogNCwgY29sOiAzLCBsZW5ndGg6IDMsIGlzVmVydGljYWw6IHRydWUsXG4gIH0pO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogMiwgY29sOiA1LCBsZW5ndGg6IDQsIGlzVmVydGljYWw6IGZhbHNlLFxuICB9KTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDYsIGNvbDogNSwgbGVuZ3RoOiA1LCBpc1ZlcnRpY2FsOiBmYWxzZSxcbiAgfSk7XG5cbiAgcmV0dXJuIGJvYXJkO1xufVxuXG5mdW5jdGlvbiBxdWlja0JvYXJkU2V0dXAoKSB7XG4gIGNvbnN0IGJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogNCwgY29sOiA1LCBsZW5ndGg6IDIsIGlzVmVydGljYWw6IHRydWUsXG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn1cblxuZnVuY3Rpb24gcHJvbXB0VGFyZ2V0aW5nKCkge1xuICBjb25zdCByb3cgPSBwcm9tcHQoJ1NlbGVjdCBhIHJvdycpO1xuICBjb25zdCBjb2wgPSBwcm9tcHQoJ1NlbGVjdCBhIGNvbCcpO1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyb3csIGNvbF0pO1xufVxuXG5mdW5jdGlvbiBjbGlja1RhcmdldGluZyhwdWJzdWIpIHtcbiAgbGV0IGV2ZW50UmVmO1xuXG4gIC8vIGNyZWF0ZSBwcm9taXNlXG4gIGNvbnN0IHRhcmdldFByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgIC8vIGNyZWF0ZSBmdW5jdGlvbiB0byBwYXNzIHRvIHB1YnN1YlxuICAgIGNvbnN0IGdldENsaWNrID0gKHJvdywgY29sKSA9PiB7XG4gICAgICByZXNvbHZlKFtyb3csIGNvbF0pO1xuICAgIH07XG4gICAgZXZlbnRSZWYgPSBwdWJzdWIuc3Vic2NyaWJlKCd0YXJnZXQtc2VsZWN0JywgZ2V0Q2xpY2spO1xuICB9KTtcblxuICAvLyB1bnN1YnNjcmliZSBvbmNlIHByb21pc2UgaXMgZG9uZSBiZWluZyB1c2VkXG4gIHRhcmdldFByb21pc2UuZmluYWxseSgoKSA9PiB7XG4gICAgZXZlbnRSZWYudW5zdWJzY3JpYmUoKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHRhcmdldFByb21pc2U7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1bkdhbWUoKSB7XG4gIC8vIGNyZWF0ZSBwbGF5ZXIgMVxuICBjb25zdCBwbGF5ZXIxID0gcGxheWVyRmFjdG9yeSgpO1xuICAvLyBjcmVhdGUgcGxheWVyIDJcbiAgY29uc3QgcGxheWVyMiA9IHBsYXllckZhY3RvcnkoKTtcbiAgLy8gY3JlYXRlIGJvYXJkIDFcbiAgY29uc3QgYm9hcmQxID0gc3RhdGljQm9hcmRTZXR1cCgpO1xuICAvLyBjcmVhdGUgYm9hcmQgMlxuICBjb25zdCBib2FyZDIgPSBzdGF0aWNCb2FyZFNldHVwKCk7XG5cbiAgY29uc3QgcHVic3ViID0gZXZlbnRFbWl0dGVyKCk7XG4gIGNvbnN0IG1vZENsaWNrVGFyZ2V0ID0gKCkgPT4gY2xpY2tUYXJnZXRpbmcocHVic3ViKTtcblxuICAvLyBvbmUgYm9hcmQgY29udGFpbmVyXG4gIGNvbnN0IGNvbnRhaW5lcjEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9hcmQxJyk7XG4gIGNvbnN0IGNvbnRhaW5lcjIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYm9hcmQyJyk7XG4gIGNvbnN0IGdhbWVMb2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbG9nJyk7XG4gIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIxLCBib2FyZDEsIHRydWUpO1xuICBib2FyZERyYXdlci5kcmF3Qm9hcmQoY29udGFpbmVyMiwgYm9hcmQyLCBmYWxzZSwgcHVic3ViKTtcblxuICAvLyBzdGFydCBsb29wXG4gIHdoaWxlICghYm9hcmQxLmlzQWxsU3VuaygpKSB7XG4gICAgLy8gZHJhdyBib2FyZFxuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIxLCBib2FyZDEsIHRydWUpO1xuICAgIC8vIGFzayBodW1hbiBwbGF5ZXIgdG8gY2hvb3NlIHRhcmdldFxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29wXG4gICAgY29uc3QgYWN0aW9uMSA9IGF3YWl0IHBsYXllcjEudGFrZVR1cm4oYm9hcmQyLCBtb2RDbGlja1RhcmdldCk7XG4gICAgYm9hcmREcmF3ZXIubG9nRXZlbnQoZ2FtZUxvZywgYWN0aW9uMSwgJ0h1bWFuJyk7XG4gICAgLy8gYWxsb3cgY2xpY2tpbmcgb24gYm9hcmRcbiAgICAvLyBvbmNlIHRhcmdldCBpcyBzZWxlY3RlZCwgZW5kIGNsaWNraW5nXG5cbiAgICAvLyBjaGVjayBpZiBBSSBsb3Nlc1xuICAgIGlmIChib2FyZDIuaXNBbGxTdW5rKCkpIHtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgICAvLyBkb24ndCByZWRyYXcgYm9hcmRcbiAgICBib2FyZERyYXdlci5kcmF3Qm9hcmQoY29udGFpbmVyMiwgYm9hcmQyLCBmYWxzZSwgcHVic3ViKTtcbiAgICAvLyBBSSBjaG9vc2UgdGFyZ2V0XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3BcbiAgICBjb25zdCBhY3Rpb24yID0gYXdhaXQgcGxheWVyMi50YWtlVHVybihib2FyZDEsIHBsYXllcjIuYWlUYXJnZXQpO1xuICAgIGJvYXJkRHJhd2VyLmxvZ0V2ZW50KGdhbWVMb2csIGFjdGlvbjIsICdBSScpO1xuICAvLyBjaGVjayBpZiBodW1hbiBsb3Nlc1xuICAvLyBiYWNrIHRvIHRvcCBvZiBsb29wXG4gIH1cbiAgaWYgKGJvYXJkMS5pc0FsbFN1bmsoKSkge1xuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIxLCBib2FyZDEsIHRydWUpO1xuICAgIC8vIHJldmVhbCBBSSdzIHJlbWFpbmluZyBzaGlwc1xuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIsIHRydWUpO1xuICAgIGJvYXJkRHJhd2VyLmxvZ1dpbm5lcihnYW1lTG9nLCAnQUknKTtcbiAgfSBlbHNlIHtcbiAgICBib2FyZERyYXdlci5kcmF3Qm9hcmQoY29udGFpbmVyMiwgYm9hcmQyLCB0cnVlKTtcbiAgICBib2FyZERyYXdlci5sb2dXaW5uZXIoZ2FtZUxvZywgJ0h1bWFuJyk7XG4gIH1cblxuICAvLyBleGl0IGZ1bmN0aW9uXG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgcnVuR2FtZSB9O1xuIiwiY29uc3QgZXZlbnRFbWl0dGVyID0gKG9sZEV2ZW50TGlzdCkgPT4ge1xuICBjb25zdCBldmVudHMgPSBvbGRFdmVudExpc3QgfHwge307XG5cbiAgY29uc3Qgc3Vic2NyaWJlID0gKGV2ZW50TmFtZSwgY2IpID0+IHtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLWV4cHJlc3Npb25zXG4gICAgKGV2ZW50c1tldmVudE5hbWVdIHx8IChldmVudHNbZXZlbnROYW1lXSA9IFtdKSkucHVzaChjYik7XG5cbiAgICBjb25zdCB1bnN1YnNjcmliZSA9ICgpID0+IHtcbiAgICAgIGlmIChldmVudHNbZXZlbnROYW1lXSkge1xuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZVxuICAgICAgICBldmVudHNbZXZlbnROYW1lXS5zcGxpY2UoZXZlbnRzW2V2ZW50TmFtZV0uaW5kZXhPZihjYikgPj4+IDAsIDEpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICByZXR1cm4geyB1bnN1YnNjcmliZSB9O1xuICB9O1xuXG4gIGNvbnN0IGVtaXQgPSAoZXZlbnROYW1lLCBhcmdzKSA9PiB7XG4gICAgKGV2ZW50c1tldmVudE5hbWVdIHx8IFtdKS5mb3JFYWNoKChmbikgPT4ge1xuICAgICAgZm4oLi4uYXJncyk7XG4gICAgfSk7XG4gIH07XG5cbiAgcmV0dXJuIHsgc3Vic2NyaWJlLCBlbWl0IH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBldmVudEVtaXR0ZXI7XG4iLCJpbXBvcnQgZ2FtZUxvb3AgZnJvbSAnLi9nYW1lTG9vcCc7XG5cbi8vIHRlc3QgdGhhdCB3ZWJwYWNrIHdvcmtzXG5jb25zb2xlLmxvZygnd2VicGFjayBjb21waWxlZCB0byBtYWluLmpzJyk7XG5cbmNvbnN0IHdhaXRGb3JQYWdlID0gUHJvbWlzZS5yZXNvbHZlKCdsb2FkZWQnKTtcbndhaXRGb3JQYWdlLnRoZW4oKCkgPT4ge1xuICBnYW1lTG9vcC5ydW5HYW1lKCk7XG59KTtcblxuY29uc29sZS5sb2coJ2VuZCBvZiBtYWluLmpzJyk7XG4iXSwibmFtZXMiOlsiYm9hcmQiLCJzaGlwcyIsImkiLCJBcnJheSIsImZpbGwiLCJnZXRUaWxlIiwicm93IiwiY29sIiwicGxhY2VTaGlwIiwibGVuZ3RoIiwiaXNWZXJ0aWNhbCIsInNoaXAiLCJoaXRzIiwiZ2V0TGVuZ3RoIiwiaXNTdW5rIiwiZXZlcnkiLCJ2YWx1ZSIsImhpdCIsImluZGV4IiwicHVzaCIsInBvcyIsInJlY2VpdmVBdHRhY2siLCJjZWxsIiwibWlzcyIsImlzQWxsU3VuayIsImlzVmFsaWRUYXJnZXQiLCJnZXRXaWR0aCIsImdldEhlaWdodCIsImhpdFN0YWNrIiwic2VhcmNoQ291bnQiLCJzZWFyY2hPZmZzZXRzIiwicmFuZEludCIsIm51bSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJhbmRvbVRhcmdldCIsIlByb21pc2UiLCJyZXNvbHZlIiwidGFrZVR1cm4iLCJhc3luYyIsIm90aGVyQm9hcmQiLCJ0YXJnZXRGdW5jIiwidmFsaWRUYXJnZXQiLCJhaVRhcmdldCIsInBvcCIsIm9mZnNldCIsImdldFRpbGVHcm91cCIsImlzT3duQm9hcmQiLCJzeW1ib2wiLCJjYXRlZ29yeSIsImNvbnRhaW5lciIsInB1YnN1YiIsImJvYXJkRWxlbSIsInBhcmVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsInRhYmxlIiwiYXBwZW5kQ2hpbGQiLCJ3aWR0aCIsImhlaWdodCIsInRSb3ciLCJ0RGl2IiwiYnV0dG9uIiwiYXBwZW5kIiwiZ3JvdXAiLCJjbGFzc05hbWUiLCJpbm5lclRleHQiLCJhZGRFdmVudExpc3RlbmVyIiwiZW1pdCIsImNyZWF0ZUJvYXJkRWxlbSIsImZpcnN0Q2hpbGQiLCJyZXBsYWNlQ2hpbGQiLCJhY3Rpb24iLCJwbGF5ZXIiLCJlbGVtIiwibG9nRWxlbSIsImNyZWF0ZUV2ZW50TG9nRWxlbSIsInN0YXRpY0JvYXJkU2V0dXAiLCJnYW1lYm9hcmQiLCJwbGF5ZXIxIiwicGxheWVyMiIsImJvYXJkMSIsImJvYXJkMiIsIm9sZEV2ZW50TGlzdCIsImV2ZW50cyIsInN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNiIiwidW5zdWJzY3JpYmUiLCJzcGxpY2UiLCJpbmRleE9mIiwiYXJncyIsImZvckVhY2giLCJmbiIsIm1vZENsaWNrVGFyZ2V0IiwiZXZlbnRSZWYiLCJ0YXJnZXRQcm9taXNlIiwiZmluYWxseSIsImNsaWNrVGFyZ2V0aW5nIiwiY29udGFpbmVyMSIsImdldEVsZW1lbnRCeUlkIiwiY29udGFpbmVyMiIsImdhbWVMb2ciLCJhY3Rpb24xIiwiYWN0aW9uMiIsImNvbnNvbGUiLCJsb2ciLCJ0aGVuIiwiZ2FtZUxvb3AiXSwic291cmNlUm9vdCI6IiJ9