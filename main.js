(()=>{"use strict";const e=()=>{const e=[],t=[];for(let t=0;t<10;t+=1)e[t]=new Array(10).fill({});return{getTile:(t,n)=>e[t][n],placeShip:({row:n,col:o,length:s,isVertical:r})=>{const l=(e=>{const t=new Array(e).fill(!1);return{getLength:()=>e,isSunk:()=>t.every((e=>e)),hit:e=>{t[e]=!0}}})(s);if(t.push(l),r)for(let t=0;t<s;t+=1)e[n+t][o]={ship:l,pos:t};else for(let t=0;t<s;t+=1)e[n][o+t]={ship:l,pos:t}},receiveAttack:(t,n)=>{const o=e[t][n];return o.ship?(o.hit=!0,o.ship.hit(o.pos),!0):(e[t][n]={miss:!0},!1)},isAllSunk:()=>t.every((e=>e.isSunk())),isValidTarget:(t,n)=>{const o=e[t][n];return!(o.miss||o.hit)},getWidth:()=>e[0].length,getHeight:()=>e.length}},t=()=>{const e=[];let t=0;const n=[[0,-1],[-1,0],[0,1],[1,0]],o=e=>Math.floor(e*Math.random()),s=()=>{const e=o(10),t=o(10);return Promise.resolve([e,t])};return{takeTurn:async function(n,o){let s,r,l=!1;for(;!l;)[s,r]=await o(),l=n.isValidTarget(s,r);const i=n.receiveAttack(s,r);return i&&(e.push([s,r]),t=0),Promise.resolve({row:s,col:r,hit:i})},randomTarget:s,aiTarget:()=>{if(4===t&&(e.pop(),t=0),0===e.length)return s();let o,r;[o,r]=e[e.length-1];const l=n[t];return o+=l[0],r+=l[1],t+=1,Promise.resolve([o,r])}}};function n(e,t){const n=document.createElement("td");return e.hit||e.miss||e.ship&&t?e.miss?(n.className="cell-miss",n.innerText="."):e.hit&&e.ship.isSunk()?(n.className="cell-sunk",n.innerText="X"):e.hit?(n.className="cell-hit",n.innerText="x"):(n.className="cell-ship",n.innerText="T"):(n.className="cell-empty",n.innerText="O"),n}function o(e,t=!1){console.log("board draw",t);const o=document.createElement("div"),s=document.createElement("table");o.appendChild(s);const r=e.getWidth(),l=e.getHeight();for(let o=0;o<l;o+=1){const l=document.createElement("tr");s.appendChild(l);for(let s=0;s<r;s+=1){const r=n(e.getTile(o,s),t);l.appendChild(r)}}return o}const s=function(e,t,n){console.log("drawing borad");const s=o(t,n);e.firstChild?e.replaceChild(s,e.firstChild):e.appendChild(s)};function r(){const t=e();return t.placeShip({row:4,col:5,length:2,isVertical:!0}),t}function l(){const e=prompt("Select a row"),t=prompt("Select a col");return Promise.resolve([e,t])}const i=async function(){const e=t(),n=t(),o=r(),i=r(),c=document.getElementById("board1"),a=document.getElementById("board2");for(s(c,o,!0),s(a,i);!o.isAllSunk();){s(c,o,!0);const t=await e.takeTurn(i,l);if(console.log("Human: ",t),i.isAllSunk())break;s(a,i);const r=await n.takeTurn(o,n.aiTarget);console.log("AI: ",r)}s(c,o,!0),s(a,i),console.log("game over")};console.log("webpack compiled to main.js"),Promise.resolve("loaded").then((()=>{i()})),console.log("end of main.js")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QnRELEVBQU9nRCxHQUNyQ2UsRUFBVUUsV0FBY0YsRUFBVUcsYUFBYUYsRUFBV0QsRUFBVUUsWUFBc0JGLEVBQVVKLFlBQVlLLElDekJ0SCxTQUFTRyxJQUNQLE1BQU1uRSxFQUFRb0UsSUFLZCxPQUpBcEUsRUFBTVEsVUFBVSxDQUNkRixJQUFLLEVBQUdDLElBQUssRUFBR0UsT0FBUSxFQUFHQyxZQUFZLElBR2xDVixFQUdULFNBQVNxRSxJQUNQLE1BQU0vRCxFQUFNZ0UsT0FBTyxnQkFDYi9ELEVBQU0rRCxPQUFPLGdCQUNuQixPQUFPakMsUUFBUUMsUUFBUSxDQUFDaEMsRUFBS0MsSUFpRC9CLFFBOUNBaUMsaUJBRUUsTUFBTStCLEVBQVVDLElBRVZDLEVBQVVELElBRVZFLEVBQVNQLElBRVRRLEVBQVNSLElBR1RTLEVBQWExQixTQUFTMkIsZUFBZSxVQUNyQ0MsRUFBYTVCLFNBQVMyQixlQUFlLFVBSzNDLElBSkEsRUFBc0JELEVBQVlGLEdBQVEsR0FDMUMsRUFBc0JJLEVBQVlILElBRzFCRCxFQUFPbEQsYUFBYSxDQUUxQixFQUFzQm9ELEVBQVlGLEdBQVEsR0FHMUMsTUFBTUssUUFBZ0JSLEVBQVFoQyxTQUFTb0MsRUFBUU4sR0FNL0MsR0FMQWQsUUFBUUMsSUFBSSxVQUFXdUIsR0FLbkJKLEVBQU9uRCxZQUNULE1BR0YsRUFBc0JzRCxFQUFZSCxHQUdsQyxNQUFNSyxRQUFnQlAsRUFBUWxDLFNBQVNtQyxFQUFRRCxFQUFRN0IsVUFDdkRXLFFBQVFDLElBQUksT0FBUXdCLEdBSXRCLEVBQXNCSixFQUFZRixHQUFRLEdBQzFDLEVBQXNCSSxFQUFZSCxHQUVsQ3BCLFFBQVFDLElBQUksY0NoRmRELFFBQVFDLElBQUksK0JBRVFuQixRQUFRQyxRQUFRLFVBQ3hCMkMsTUFBSyxLQUNmQyxPQUdGM0IsUUFBUUMsSUFBSSxtQiIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2RyYXdCb2FyZC5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWVMb29wLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qgc2hpcEZhY3RvcnkgPSAobGVuZ3RoKSA9PiB7XG4gIGNvbnN0IGhpdHMgPSBuZXcgQXJyYXkobGVuZ3RoKS5maWxsKGZhbHNlKTtcblxuICBjb25zdCBnZXRMZW5ndGggPSAoKSA9PiBsZW5ndGg7XG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IGhpdHMuZXZlcnkoKHZhbHVlKSA9PiB2YWx1ZSk7XG4gIGNvbnN0IGhpdCA9IChpbmRleCkgPT4ge1xuICAgIGhpdHNbaW5kZXhdID0gdHJ1ZTtcbiAgfTtcblxuICByZXR1cm4geyBnZXRMZW5ndGgsIGlzU3VuaywgaGl0IH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzaGlwRmFjdG9yeTtcbiIsImltcG9ydCBzaGlwRmFjdG9yeSBmcm9tICcuL3NoaXAnO1xuXG5jb25zdCBnYW1lYm9hcmRGYWN0b3J5ID0gKCkgPT4ge1xuICBjb25zdCBib2FyZFNpemUgPSAxMDtcbiAgY29uc3QgYm9hcmQgPSBbXTtcbiAgY29uc3Qgc2hpcHMgPSBbXTtcblxuICBmb3IgKGxldCBpID0gMDsgaSA8IGJvYXJkU2l6ZTsgaSArPSAxKSB7XG4gICAgYm9hcmRbaV0gPSBuZXcgQXJyYXkoYm9hcmRTaXplKS5maWxsKHt9KTtcbiAgfVxuXG4gIGNvbnN0IGdldFRpbGUgPSAocm93LCBjb2wpID0+IGJvYXJkW3Jvd11bY29sXTtcblxuICBjb25zdCBwbGFjZVNoaXAgPSAoe1xuICAgIHJvdywgY29sLCBsZW5ndGgsIGlzVmVydGljYWwsXG4gIH0pID0+IHtcbiAgICBjb25zdCBzaGlwID0gc2hpcEZhY3RvcnkobGVuZ3RoKTtcbiAgICBzaGlwcy5wdXNoKHNoaXApO1xuICAgIGlmIChpc1ZlcnRpY2FsKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGJvYXJkW3JvdyArIGldW2NvbF0gPSB7XG4gICAgICAgICAgc2hpcCxcbiAgICAgICAgICBwb3M6IGksXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYm9hcmRbcm93XVtjb2wgKyBpXSA9IHtcbiAgICAgICAgICBzaGlwLFxuICAgICAgICAgIHBvczogaSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChyb3csIGNvbCkgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBib2FyZFtyb3ddW2NvbF07XG4gICAgaWYgKGNlbGwuc2hpcCkge1xuICAgICAgY2VsbC5oaXQgPSB0cnVlO1xuICAgICAgY2VsbC5zaGlwLmhpdChjZWxsLnBvcyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgLy8gY3JlYXRlIG5ldyBjZWxsIGJlY2F1c2UgYWxsIGVtcHR5IGNlbGxzIHJlZmVyZW5jZSBzYW1lIG9iamVjdFxuICAgIGJvYXJkW3Jvd11bY29sXSA9IHsgbWlzczogdHJ1ZSB9O1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBjb25zdCBpc0FsbFN1bmsgPSAoKSA9PiBzaGlwcy5ldmVyeSgoc2hpcCkgPT4gc2hpcC5pc1N1bmsoKSk7XG5cbiAgY29uc3QgaXNWYWxpZFRhcmdldCA9IChyb3csIGNvbCkgPT4ge1xuICAgIGNvbnN0IGNlbGwgPSBib2FyZFtyb3ddW2NvbF07XG4gICAgcmV0dXJuICEoY2VsbC5taXNzIHx8IGNlbGwuaGl0KTtcbiAgfTtcblxuICBjb25zdCBnZXRXaWR0aCA9ICgpID0+IGJvYXJkWzBdLmxlbmd0aDtcbiAgY29uc3QgZ2V0SGVpZ2h0ID0gKCkgPT4gYm9hcmQubGVuZ3RoO1xuXG4gIHJldHVybiB7XG4gICAgZ2V0VGlsZSwgcGxhY2VTaGlwLCByZWNlaXZlQXR0YWNrLCBpc0FsbFN1bmssIGlzVmFsaWRUYXJnZXQsIGdldFdpZHRoLCBnZXRIZWlnaHQsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBnYW1lYm9hcmRGYWN0b3J5O1xuIiwiaW1wb3J0IGdhbWVib2FyZEZhY3RvcnkgZnJvbSAnLi9nYW1lYm9hcmQnO1xuXG5jb25zdCBwbGF5ZXJGYWN0b3J5ID0gKCkgPT4ge1xuICBjb25zdCBib2FyZFNpemUgPSAxMDtcbiAgY29uc3QgaGl0U3RhY2sgPSBbXTtcbiAgbGV0IHNlYXJjaENvdW50ID0gMDtcbiAgY29uc3Qgc2VhcmNoT2Zmc2V0cyA9IFtbMCwgLTFdLCBbLTEsIDBdLCBbMCwgMV0sIFsxLCAwXV07XG5cbiAgY29uc3QgdGFrZVR1cm4gPSBhc3luYyBmdW5jdGlvbiB0YWtlVHVybihvdGhlckJvYXJkLCB0YXJnZXRGdW5jKSB7XG4gICAgbGV0IHZhbGlkVGFyZ2V0ID0gZmFsc2U7XG4gICAgbGV0IHJvdztcbiAgICBsZXQgY29sO1xuICAgIHdoaWxlICghdmFsaWRUYXJnZXQpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1hd2FpdC1pbi1sb29wXG4gICAgICBbcm93LCBjb2xdID0gYXdhaXQgdGFyZ2V0RnVuYygpO1xuICAgICAgdmFsaWRUYXJnZXQgPSBvdGhlckJvYXJkLmlzVmFsaWRUYXJnZXQocm93LCBjb2wpO1xuICAgIH1cblxuICAgIGNvbnN0IGhpdCA9IG90aGVyQm9hcmQucmVjZWl2ZUF0dGFjayhyb3csIGNvbCk7XG4gICAgaWYgKGhpdCkge1xuICAgICAgaGl0U3RhY2sucHVzaChbcm93LCBjb2xdKTtcbiAgICAgIHNlYXJjaENvdW50ID0gMDtcbiAgICB9XG4gICAgLy8gY29uc29sZS5sb2coJ3RhcmdldGVkJywgcm93LCBjb2wpO1xuXG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7IHJvdywgY29sLCBoaXQgfSk7XG4gIH07XG5cbiAgY29uc3QgcmFuZEludCA9IChudW0pID0+IE1hdGguZmxvb3IobnVtICogTWF0aC5yYW5kb20oKSk7XG5cbiAgY29uc3QgcmFuZG9tVGFyZ2V0ID0gKCkgPT4ge1xuICAgIGNvbnN0IHJvdyA9IHJhbmRJbnQoYm9hcmRTaXplKTtcbiAgICBjb25zdCBjb2wgPSByYW5kSW50KGJvYXJkU2l6ZSk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcm93LCBjb2xdKTtcbiAgfTtcblxuICBjb25zdCBhaVRhcmdldCA9ICgpID0+IHtcbiAgICBpZiAoc2VhcmNoQ291bnQgPT09IDQpIHtcbiAgICAgIGhpdFN0YWNrLnBvcCgpO1xuICAgICAgc2VhcmNoQ291bnQgPSAwO1xuICAgIH1cbiAgICBpZiAoaGl0U3RhY2subGVuZ3RoID09PSAwKSB7XG4gICAgICBjb25zdCByYW5kb21Qcm9taXNlID0gcmFuZG9tVGFyZ2V0KCk7XG4gICAgICByZXR1cm4gcmFuZG9tUHJvbWlzZTtcbiAgICB9XG4gICAgbGV0IHJvdztcbiAgICBsZXQgY29sO1xuICAgIFtyb3csIGNvbF0gPSBoaXRTdGFja1toaXRTdGFjay5sZW5ndGggLSAxXTtcbiAgICBjb25zdCBvZmZzZXQgPSBzZWFyY2hPZmZzZXRzW3NlYXJjaENvdW50XTtcbiAgICByb3cgKz0gb2Zmc2V0WzBdO1xuICAgIGNvbCArPSBvZmZzZXRbMV07XG4gICAgc2VhcmNoQ291bnQgKz0gMTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyb3csIGNvbF0pO1xuICB9O1xuXG4gIHJldHVybiB7XG4gICAgdGFrZVR1cm4sIHJhbmRvbVRhcmdldCwgYWlUYXJnZXQsXG4gIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBwbGF5ZXJGYWN0b3J5O1xuIiwiLy8gcHJlcGFyZSBhbiBodG1sIGVsZW1lbnQgdG8gcmVwcmVzZW50IGEgMTB4MTAgYm9hcmRcbmZ1bmN0aW9uIGNyZWF0ZVRpbGVFbGVtKGNlbGwsIGlzT3duQm9hcmQpIHtcbiAgY29uc3QgdERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gIGlmICghY2VsbC5oaXQgJiYgIWNlbGwubWlzcyAmJiAoIWNlbGwuc2hpcCB8fCAhaXNPd25Cb2FyZCkpIHtcbiAgICAvLyBubyBzaG90IHlldCwgbm8gc2hpcCBvciBlbmVteSBzaGlwIHRoYXQgcmVtYWlucyBoaWRkZW5cbiAgICB0RGl2LmNsYXNzTmFtZSA9ICdjZWxsLWVtcHR5JztcbiAgICB0RGl2LmlubmVyVGV4dCA9ICdPJztcbiAgfSBlbHNlIGlmIChjZWxsLm1pc3MpIHtcbiAgICAvLyBtaXNzZWQgc2hvdFxuICAgIHREaXYuY2xhc3NOYW1lID0gJ2NlbGwtbWlzcyc7XG4gICAgdERpdi5pbm5lclRleHQgPSAnLic7XG4gIH0gZWxzZSBpZiAoY2VsbC5oaXQgJiYgY2VsbC5zaGlwLmlzU3VuaygpKSB7XG4gICAgLy8gaGl0IGFuZCBzdW5rXG4gICAgdERpdi5jbGFzc05hbWUgPSAnY2VsbC1zdW5rJztcbiAgICB0RGl2LmlubmVyVGV4dCA9ICdYJztcbiAgfSBlbHNlIGlmIChjZWxsLmhpdCkge1xuICAgIC8vIG9ubHkgYSBoaXRcbiAgICB0RGl2LmNsYXNzTmFtZSA9ICdjZWxsLWhpdCc7XG4gICAgdERpdi5pbm5lclRleHQgPSAneCc7XG4gIH0gZWxzZSB7XG4gICAgLy8gYSBzaGlwIHRoYXQgYmVsb25ncyB0byB0aGUgcGxheWVyXG4gICAgdERpdi5jbGFzc05hbWUgPSAnY2VsbC1zaGlwJztcbiAgICB0RGl2LmlubmVyVGV4dCA9ICdUJztcbiAgfVxuICByZXR1cm4gdERpdjtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQm9hcmRFbGVtKGJvYXJkLCBpc093bkJvYXJkID0gZmFsc2UpIHtcbiAgY29uc29sZS5sb2coJ2JvYXJkIGRyYXcnLCBpc093bkJvYXJkKTtcbiAgY29uc3QgcGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgcGFyZW50LmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgY29uc3Qgd2lkdGggPSBib2FyZC5nZXRXaWR0aCgpO1xuICBjb25zdCBoZWlnaHQgPSBib2FyZC5nZXRIZWlnaHQoKTtcblxuICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBoZWlnaHQ7IHJvdyArPSAxKSB7XG4gICAgY29uc3QgdFJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgdGFibGUuYXBwZW5kQ2hpbGQodFJvdyk7XG4gICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgd2lkdGg7IGNvbCArPSAxKSB7XG4gICAgICBjb25zdCB0RGl2ID0gY3JlYXRlVGlsZUVsZW0oYm9hcmQuZ2V0VGlsZShyb3csIGNvbCksIGlzT3duQm9hcmQpO1xuICAgICAgdFJvdy5hcHBlbmRDaGlsZCh0RGl2KTtcbiAgICAgIC8vIGFkZCBldmVudCBsaXN0ZW5lciB0byBjZWxsIGZvciBpbnB1dHNcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHBhcmVudDtcbn1cblxuZnVuY3Rpb24gZHJhd0JvYXJkKGNvbnRhaW5lciwgYm9hcmQsIGlzT3duQm9hcmQpIHtcbiAgY29uc29sZS5sb2coJ2RyYXdpbmcgYm9yYWQnKTtcbiAgY29uc3QgYm9hcmRFbGVtID0gY3JlYXRlQm9hcmRFbGVtKGJvYXJkLCBpc093bkJvYXJkKTtcbiAgaWYgKGNvbnRhaW5lci5maXJzdENoaWxkKSB7IGNvbnRhaW5lci5yZXBsYWNlQ2hpbGQoYm9hcmRFbGVtLCBjb250YWluZXIuZmlyc3RDaGlsZCk7IH0gZWxzZSB7IGNvbnRhaW5lci5hcHBlbmRDaGlsZChib2FyZEVsZW0pOyB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgY3JlYXRlQm9hcmRFbGVtLCBkcmF3Qm9hcmQgfTtcbiIsImltcG9ydCBnYW1lYm9hcmRGYWN0b3J5IGZyb20gJy4vZ2FtZWJvYXJkJztcbmltcG9ydCBwbGF5ZXJGYWN0b3J5IGZyb20gJy4vcGxheWVyJztcbmltcG9ydCBib2FyZERyYXdlciBmcm9tICcuL2RyYXdCb2FyZCc7XG5cbmZ1bmN0aW9uIHN0YXRpY0JvYXJkU2V0dXAoKSB7XG4gIGNvbnN0IGJvYXJkID0gZ2FtZWJvYXJkRmFjdG9yeSgpO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogMCwgY29sOiAyLCBsZW5ndGg6IDIsIGlzVmVydGljYWw6IGZhbHNlLFxuICB9KTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDMsIGNvbDogMCwgbGVuZ3RoOiAzLCBpc1ZlcnRpY2FsOiBmYWxzZSxcbiAgfSk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiA0LCBjb2w6IDMsIGxlbmd0aDogMywgaXNWZXJ0aWNhbDogdHJ1ZSxcbiAgfSk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiAyLCBjb2w6IDUsIGxlbmd0aDogNCwgaXNWZXJ0aWNhbDogZmFsc2UsXG4gIH0pO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogNiwgY29sOiA1LCBsZW5ndGg6IDUsIGlzVmVydGljYWw6IGZhbHNlLFxuICB9KTtcblxuICByZXR1cm4gYm9hcmQ7XG59XG5cbmZ1bmN0aW9uIHF1aWNrQm9hcmRTZXR1cCgpIHtcbiAgY29uc3QgYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KCk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiA0LCBjb2w6IDUsIGxlbmd0aDogMiwgaXNWZXJ0aWNhbDogdHJ1ZSxcbiAgfSk7XG5cbiAgcmV0dXJuIGJvYXJkO1xufVxuXG5mdW5jdGlvbiBwcm9tcHRUYXJnZXRpbmcoKSB7XG4gIGNvbnN0IHJvdyA9IHByb21wdCgnU2VsZWN0IGEgcm93Jyk7XG4gIGNvbnN0IGNvbCA9IHByb21wdCgnU2VsZWN0IGEgY29sJyk7XG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoW3JvdywgY29sXSk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIHJ1bkdhbWUoKSB7XG4gIC8vIGNyZWF0ZSBwbGF5ZXIgMVxuICBjb25zdCBwbGF5ZXIxID0gcGxheWVyRmFjdG9yeSgpO1xuICAvLyBjcmVhdGUgcGxheWVyIDJcbiAgY29uc3QgcGxheWVyMiA9IHBsYXllckZhY3RvcnkoKTtcbiAgLy8gY3JlYXRlIGJvYXJkIDFcbiAgY29uc3QgYm9hcmQxID0gcXVpY2tCb2FyZFNldHVwKCk7XG4gIC8vIGNyZWF0ZSBib2FyZCAyXG4gIGNvbnN0IGJvYXJkMiA9IHF1aWNrQm9hcmRTZXR1cCgpO1xuXG4gIC8vIG9uZSBib2FyZCBjb250YWluZXJcbiAgY29uc3QgY29udGFpbmVyMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib2FyZDEnKTtcbiAgY29uc3QgY29udGFpbmVyMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib2FyZDInKTtcbiAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjEsIGJvYXJkMSwgdHJ1ZSk7XG4gIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIpO1xuXG4gIC8vIHN0YXJ0IGxvb3BcbiAgd2hpbGUgKCFib2FyZDEuaXNBbGxTdW5rKCkpIHtcbiAgICAvLyBkcmF3IGJvYXJkXG4gICAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjEsIGJvYXJkMSwgdHJ1ZSk7XG4gICAgLy8gYXNrIGh1bWFuIHBsYXllciB0byBjaG9vc2UgdGFyZ2V0XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3BcbiAgICBjb25zdCBhY3Rpb24xID0gYXdhaXQgcGxheWVyMS50YWtlVHVybihib2FyZDIsIHByb21wdFRhcmdldGluZyk7XG4gICAgY29uc29sZS5sb2coJ0h1bWFuOiAnLCBhY3Rpb24xKTtcbiAgICAvLyBhbGxvdyBjbGlja2luZyBvbiBib2FyZFxuICAgIC8vIG9uY2UgdGFyZ2V0IGlzIHNlbGVjdGVkLCBlbmQgY2xpY2tpbmdcblxuICAgIC8vIGNoZWNrIGlmIEFJIGxvc2VzXG4gICAgaWYgKGJvYXJkMi5pc0FsbFN1bmsoKSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIC8vIGRvbid0IHJlZHJhdyBib2FyZFxuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIpO1xuICAgIC8vIEFJIGNob29zZSB0YXJnZXRcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcFxuICAgIGNvbnN0IGFjdGlvbjIgPSBhd2FpdCBwbGF5ZXIyLnRha2VUdXJuKGJvYXJkMSwgcGxheWVyMi5haVRhcmdldCk7XG4gICAgY29uc29sZS5sb2coJ0FJOiAnLCBhY3Rpb24yKTtcbiAgLy8gY2hlY2sgaWYgaHVtYW4gbG9zZXNcbiAgLy8gYmFjayB0byB0b3Agb2YgbG9vcFxuICB9XG4gIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIxLCBib2FyZDEsIHRydWUpO1xuICBib2FyZERyYXdlci5kcmF3Qm9hcmQoY29udGFpbmVyMiwgYm9hcmQyKTtcbiAgLy8gZXhpdCBmdW5jdGlvblxuICBjb25zb2xlLmxvZygnZ2FtZSBvdmVyJyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHsgcnVuR2FtZSB9O1xuIiwiaW1wb3J0IGdhbWVMb29wIGZyb20gJy4vZ2FtZUxvb3AnO1xuXG4vLyB0ZXN0IHRoYXQgd2VicGFjayB3b3Jrc1xuY29uc29sZS5sb2coJ3dlYnBhY2sgY29tcGlsZWQgdG8gbWFpbi5qcycpO1xuXG5jb25zdCB3YWl0Rm9yUGFnZSA9IFByb21pc2UucmVzb2x2ZSgnbG9hZGVkJyk7XG53YWl0Rm9yUGFnZS50aGVuKCgpID0+IHtcbiAgZ2FtZUxvb3AucnVuR2FtZSgpO1xufSk7XG5cbmNvbnNvbGUubG9nKCdlbmQgb2YgbWFpbi5qcycpO1xuIl0sIm5hbWVzIjpbImJvYXJkIiwic2hpcHMiLCJpIiwiQXJyYXkiLCJmaWxsIiwiZ2V0VGlsZSIsInJvdyIsImNvbCIsInBsYWNlU2hpcCIsImxlbmd0aCIsImlzVmVydGljYWwiLCJzaGlwIiwiaGl0cyIsImdldExlbmd0aCIsImlzU3VuayIsImV2ZXJ5IiwidmFsdWUiLCJoaXQiLCJpbmRleCIsInB1c2giLCJwb3MiLCJyZWNlaXZlQXR0YWNrIiwiY2VsbCIsIm1pc3MiLCJpc0FsbFN1bmsiLCJpc1ZhbGlkVGFyZ2V0IiwiZ2V0V2lkdGgiLCJnZXRIZWlnaHQiLCJoaXRTdGFjayIsInNlYXJjaENvdW50Iiwic2VhcmNoT2Zmc2V0cyIsInJhbmRJbnQiLCJudW0iLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJyYW5kb21UYXJnZXQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRha2VUdXJuIiwiYXN5bmMiLCJvdGhlckJvYXJkIiwidGFyZ2V0RnVuYyIsInZhbGlkVGFyZ2V0IiwiYWlUYXJnZXQiLCJwb3AiLCJvZmZzZXQiLCJjcmVhdGVUaWxlRWxlbSIsImlzT3duQm9hcmQiLCJ0RGl2IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiaW5uZXJUZXh0IiwiY3JlYXRlQm9hcmRFbGVtIiwiY29uc29sZSIsImxvZyIsInBhcmVudCIsInRhYmxlIiwiYXBwZW5kQ2hpbGQiLCJ3aWR0aCIsImhlaWdodCIsInRSb3ciLCJjb250YWluZXIiLCJib2FyZEVsZW0iLCJmaXJzdENoaWxkIiwicmVwbGFjZUNoaWxkIiwicXVpY2tCb2FyZFNldHVwIiwiZ2FtZWJvYXJkIiwicHJvbXB0VGFyZ2V0aW5nIiwicHJvbXB0IiwicGxheWVyMSIsInBsYXllciIsInBsYXllcjIiLCJib2FyZDEiLCJib2FyZDIiLCJjb250YWluZXIxIiwiZ2V0RWxlbWVudEJ5SWQiLCJjb250YWluZXIyIiwiYWN0aW9uMSIsImFjdGlvbjIiLCJ0aGVuIiwiZ2FtZUxvb3AiXSwic291cmNlUm9vdCI6IiJ9