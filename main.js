(()=>{"use strict";const e=()=>{const e=[],t=[];for(let t=0;t<10;t+=1)e[t]=new Array(10).fill({});return{getTile:(t,n)=>e[t][n],placeShip:({row:n,col:i,length:r,isVertical:s})=>{const o=(e=>{const t=new Array(e).fill(!1);return{getLength:()=>e,isSunk:()=>t.every((e=>e)),hit:e=>{t[e]=!0}}})(r);if(t.push(o),s)for(let t=0;t<r;t+=1)e[n+t][i]={ship:o,pos:t};else for(let t=0;t<r;t+=1)e[n][i+t]={ship:o,pos:t}},receiveAttack:(t,n)=>{const i=e[t][n];return i.ship?(i.hit=!0,i.ship.hit(i.pos),!0):(e[t][n]={miss:!0},!1)},isAllSunk:()=>t.every((e=>e.isSunk())),isValidTarget:(t,n)=>{if(t<0||t>=10||n<0||n>=10)return!1;const i=e[t][n];return!(i.miss||i.hit)},getWidth:()=>e[0].length,getHeight:()=>e.length}},t=()=>{const e=[];let t=0;const n=[[0,-1],[-1,0],[0,1],[1,0]],i=e=>Math.floor(e*Math.random()),r=()=>{const e=i(10),t=i(10);return Promise.resolve([e,t])};return{takeTurn:async function(n,i){let r,s,o=!1;for(;!o;)[r,s]=await i(),o=n.isValidTarget(r,s);const c=n.receiveAttack(r,s);return c&&(e.push([r,s]),t=0),Promise.resolve({row:r,col:s,hit:c})},randomTarget:r,aiTarget:()=>{if(4===t&&(e.pop(),t=0),0===e.length)return r();let i,s;[i,s]=e[e.length-1];const o=n[t];return i+=o[0],s+=o[1],t+=1,Promise.resolve([i,s])}}};function n(e,t){let n,i;return e.hit||e.miss||e.ship&&t?e.miss?(i="cell-miss",n="."):e.hit&&e.ship.isSunk()?(i="cell-sunk",n="X"):e.hit?(i="cell-hit",n="x"):(i="cell-ship",n="T"):(i="cell-empty",n="O"),{symbol:n,category:i}}const i=function(e,t,i,r){const s=function(e,t=!1,i){const r=document.createElement("div"),s=document.createElement("table");r.appendChild(s);const o=e.getWidth(),c=e.getHeight();for(let r=0;r<c;r+=1){const c=document.createElement("tr");s.appendChild(c);for(let s=0;s<o;s+=1){const o=document.createElement("td");c.appendChild(o);const l=document.createElement("button");o.append(l);const a=n(e.getTile(r,s),t);l.className=a.category,l.innerText=a.symbol,!t&&i&&l.addEventListener("click",(()=>{i.emit("target-select",[r,s])}))}}return r}(t,i,r);e.firstChild?e.replaceChild(s,e.firstChild):e.appendChild(s)},r=function(e,t,n){const i=function(e,t){const n=document.createElement("p");return n.innerText=`${t} targeted [${e.row}, ${e.col}].`,e.hit&&(n.innerText+=" Hit!"),n}(t,n);e.appendChild(i)},s=function(e,t){const n=document.createElement("p");e.appendChild(n),n.innerText=`${t} Wins!`};function o(){const t=e();return t.placeShip({row:4,col:5,length:2,isVertical:!0}),t}const c=async function(){const e=t(),n=t(),c=o(),l=o(),a=(e=>{const t=e||{};return{subscribe:(e,n)=>((t[e]||(t[e]=[])).push(n),{unsubscribe:()=>{t[e]&&t[e].splice(t[e].indexOf(n)>>>0,1)}}),emit:(e,n)=>{(t[e]||[]).forEach((e=>{e(...n)}))}}})(),u=()=>function(e){let t;const n=new Promise((n=>{t=e.subscribe("target-select",((e,t)=>{n([e,t])}))}));return n.finally((()=>{t.unsubscribe()})),n}(a),d=document.getElementById("board1"),h=document.getElementById("board2"),m=document.getElementById("log");for(i(d,c,!0),i(h,l,!1,a);!c.isAllSunk();){i(d,c,!0);const t=await e.takeTurn(l,u);if(r(m,t,"Human"),l.isAllSunk())break;i(h,l,!1,a);const s=await n.takeTurn(c,n.aiTarget);r(m,s,"AI")}c.isAllSunk()?(i(d,c,!0),i(h,l,!0),s(m,"AI")):(i(h,l,!0),s(m,"Human"))};console.log("webpack compiled to main.js"),Promise.resolve("loaded").then((()=>{c()})),console.log("end of main.js")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxRQUFRLFVBQ3hCc0UsTUFBSyxLQUNmQyxPQUdGSCxRQUFRQyxJQUFJLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9zaGlwLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvcGxheWVyLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZHJhd0JvYXJkLmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUxvb3AuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9tZXNzZW5nZXIuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBzaGlwRmFjdG9yeSA9IChsZW5ndGgpID0+IHtcbiAgY29uc3QgaGl0cyA9IG5ldyBBcnJheShsZW5ndGgpLmZpbGwoZmFsc2UpO1xuXG4gIGNvbnN0IGdldExlbmd0aCA9ICgpID0+IGxlbmd0aDtcbiAgY29uc3QgaXNTdW5rID0gKCkgPT4gaGl0cy5ldmVyeSgodmFsdWUpID0+IHZhbHVlKTtcbiAgY29uc3QgaGl0ID0gKGluZGV4KSA9PiB7XG4gICAgaGl0c1tpbmRleF0gPSB0cnVlO1xuICB9O1xuXG4gIHJldHVybiB7IGdldExlbmd0aCwgaXNTdW5rLCBoaXQgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNoaXBGYWN0b3J5O1xuIiwiaW1wb3J0IHNoaXBGYWN0b3J5IGZyb20gJy4vc2hpcCc7XG5cbmNvbnN0IGdhbWVib2FyZEZhY3RvcnkgPSAoKSA9PiB7XG4gIGNvbnN0IGJvYXJkU2l6ZSA9IDEwO1xuICBjb25zdCBib2FyZCA9IFtdO1xuICBjb25zdCBzaGlwcyA9IFtdO1xuXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgYm9hcmRTaXplOyBpICs9IDEpIHtcbiAgICBib2FyZFtpXSA9IG5ldyBBcnJheShib2FyZFNpemUpLmZpbGwoe30pO1xuICB9XG5cbiAgY29uc3QgZ2V0VGlsZSA9IChyb3csIGNvbCkgPT4gYm9hcmRbcm93XVtjb2xdO1xuXG4gIGNvbnN0IHBsYWNlU2hpcCA9ICh7XG4gICAgcm93LCBjb2wsIGxlbmd0aCwgaXNWZXJ0aWNhbCxcbiAgfSkgPT4ge1xuICAgIGNvbnN0IHNoaXAgPSBzaGlwRmFjdG9yeShsZW5ndGgpO1xuICAgIHNoaXBzLnB1c2goc2hpcCk7XG4gICAgaWYgKGlzVmVydGljYWwpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgYm9hcmRbcm93ICsgaV1bY29sXSA9IHtcbiAgICAgICAgICBzaGlwLFxuICAgICAgICAgIHBvczogaSxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkgKz0gMSkge1xuICAgICAgICBib2FyZFtyb3ddW2NvbCArIGldID0ge1xuICAgICAgICAgIHNoaXAsXG4gICAgICAgICAgcG9zOiBpLFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICBjb25zdCByZWNlaXZlQXR0YWNrID0gKHJvdywgY29sKSA9PiB7XG4gICAgY29uc3QgY2VsbCA9IGJvYXJkW3Jvd11bY29sXTtcbiAgICBpZiAoY2VsbC5zaGlwKSB7XG4gICAgICBjZWxsLmhpdCA9IHRydWU7XG4gICAgICBjZWxsLnNoaXAuaGl0KGNlbGwucG9zKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICAvLyBjcmVhdGUgbmV3IGNlbGwgYmVjYXVzZSBhbGwgZW1wdHkgY2VsbHMgcmVmZXJlbmNlIHNhbWUgb2JqZWN0XG4gICAgYm9hcmRbcm93XVtjb2xdID0geyBtaXNzOiB0cnVlIH07XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGNvbnN0IGlzQWxsU3VuayA9ICgpID0+IHNoaXBzLmV2ZXJ5KChzaGlwKSA9PiBzaGlwLmlzU3VuaygpKTtcblxuICBjb25zdCBpc1ZhbGlkVGFyZ2V0ID0gKHJvdywgY29sKSA9PiB7XG4gICAgaWYgKHJvdyA8IDAgfHwgcm93ID49IGJvYXJkU2l6ZSB8fCBjb2wgPCAwIHx8IGNvbCA+PSBib2FyZFNpemUpIHsgcmV0dXJuIGZhbHNlOyB9XG4gICAgY29uc3QgY2VsbCA9IGJvYXJkW3Jvd11bY29sXTtcbiAgICByZXR1cm4gIShjZWxsLm1pc3MgfHwgY2VsbC5oaXQpO1xuICB9O1xuXG4gIGNvbnN0IGdldFdpZHRoID0gKCkgPT4gYm9hcmRbMF0ubGVuZ3RoO1xuICBjb25zdCBnZXRIZWlnaHQgPSAoKSA9PiBib2FyZC5sZW5ndGg7XG5cbiAgcmV0dXJuIHtcbiAgICBnZXRUaWxlLCBwbGFjZVNoaXAsIHJlY2VpdmVBdHRhY2ssIGlzQWxsU3VuaywgaXNWYWxpZFRhcmdldCwgZ2V0V2lkdGgsIGdldEhlaWdodCxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGdhbWVib2FyZEZhY3Rvcnk7XG4iLCJpbXBvcnQgZ2FtZWJvYXJkRmFjdG9yeSBmcm9tICcuL2dhbWVib2FyZCc7XG5cbmNvbnN0IHBsYXllckZhY3RvcnkgPSAoKSA9PiB7XG4gIGNvbnN0IGJvYXJkU2l6ZSA9IDEwO1xuICBjb25zdCBoaXRTdGFjayA9IFtdO1xuICBsZXQgc2VhcmNoQ291bnQgPSAwO1xuICBjb25zdCBzZWFyY2hPZmZzZXRzID0gW1swLCAtMV0sIFstMSwgMF0sIFswLCAxXSwgWzEsIDBdXTtcblxuICBjb25zdCB0YWtlVHVybiA9IGFzeW5jIGZ1bmN0aW9uIHRha2VUdXJuKG90aGVyQm9hcmQsIHRhcmdldEZ1bmMpIHtcbiAgICBsZXQgdmFsaWRUYXJnZXQgPSBmYWxzZTtcbiAgICBsZXQgcm93O1xuICAgIGxldCBjb2w7XG4gICAgd2hpbGUgKCF2YWxpZFRhcmdldCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3BcbiAgICAgIFtyb3csIGNvbF0gPSBhd2FpdCB0YXJnZXRGdW5jKCk7XG4gICAgICB2YWxpZFRhcmdldCA9IG90aGVyQm9hcmQuaXNWYWxpZFRhcmdldChyb3csIGNvbCk7XG4gICAgfVxuXG4gICAgY29uc3QgaGl0ID0gb3RoZXJCb2FyZC5yZWNlaXZlQXR0YWNrKHJvdywgY29sKTtcbiAgICBpZiAoaGl0KSB7XG4gICAgICBoaXRTdGFjay5wdXNoKFtyb3csIGNvbF0pO1xuICAgICAgc2VhcmNoQ291bnQgPSAwO1xuICAgIH1cbiAgICAvLyBjb25zb2xlLmxvZygndGFyZ2V0ZWQnLCByb3csIGNvbCk7XG5cbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHsgcm93LCBjb2wsIGhpdCB9KTtcbiAgfTtcblxuICBjb25zdCByYW5kSW50ID0gKG51bSkgPT4gTWF0aC5mbG9vcihudW0gKiBNYXRoLnJhbmRvbSgpKTtcblxuICBjb25zdCByYW5kb21UYXJnZXQgPSAoKSA9PiB7XG4gICAgY29uc3Qgcm93ID0gcmFuZEludChib2FyZFNpemUpO1xuICAgIGNvbnN0IGNvbCA9IHJhbmRJbnQoYm9hcmRTaXplKTtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFtyb3csIGNvbF0pO1xuICB9O1xuXG4gIGNvbnN0IGFpVGFyZ2V0ID0gKCkgPT4ge1xuICAgIGlmIChzZWFyY2hDb3VudCA9PT0gNCkge1xuICAgICAgaGl0U3RhY2sucG9wKCk7XG4gICAgICBzZWFyY2hDb3VudCA9IDA7XG4gICAgfVxuICAgIGlmIChoaXRTdGFjay5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnN0IHJhbmRvbVByb21pc2UgPSByYW5kb21UYXJnZXQoKTtcbiAgICAgIHJldHVybiByYW5kb21Qcm9taXNlO1xuICAgIH1cbiAgICBsZXQgcm93O1xuICAgIGxldCBjb2w7XG4gICAgW3JvdywgY29sXSA9IGhpdFN0YWNrW2hpdFN0YWNrLmxlbmd0aCAtIDFdO1xuICAgIGNvbnN0IG9mZnNldCA9IHNlYXJjaE9mZnNldHNbc2VhcmNoQ291bnRdO1xuICAgIHJvdyArPSBvZmZzZXRbMF07XG4gICAgY29sICs9IG9mZnNldFsxXTtcbiAgICBzZWFyY2hDb3VudCArPSAxO1xuICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoW3JvdywgY29sXSk7XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICB0YWtlVHVybiwgcmFuZG9tVGFyZ2V0LCBhaVRhcmdldCxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHBsYXllckZhY3Rvcnk7XG4iLCIvLyBwcmVwYXJlIGFuIGh0bWwgZWxlbWVudCB0byByZXByZXNlbnQgYSAxMHgxMCBib2FyZFxuZnVuY3Rpb24gZ2V0VGlsZUdyb3VwKGNlbGwsIGlzT3duQm9hcmQpIHtcbiAgbGV0IHN5bWJvbDtcbiAgbGV0IGNhdGVnb3J5O1xuICBpZiAoIWNlbGwuaGl0ICYmICFjZWxsLm1pc3MgJiYgKCFjZWxsLnNoaXAgfHwgIWlzT3duQm9hcmQpKSB7XG4gICAgLy8gbm8gc2hvdCB5ZXQsIG5vIHNoaXAgb3IgZW5lbXkgc2hpcCB0aGF0IHJlbWFpbnMgaGlkZGVuXG4gICAgY2F0ZWdvcnkgPSAnY2VsbC1lbXB0eSc7XG4gICAgc3ltYm9sID0gJ08nO1xuICB9IGVsc2UgaWYgKGNlbGwubWlzcykge1xuICAgIC8vIG1pc3NlZCBzaG90XG4gICAgY2F0ZWdvcnkgPSAnY2VsbC1taXNzJztcbiAgICBzeW1ib2wgPSAnLic7XG4gIH0gZWxzZSBpZiAoY2VsbC5oaXQgJiYgY2VsbC5zaGlwLmlzU3VuaygpKSB7XG4gICAgLy8gaGl0IGFuZCBzdW5rXG4gICAgY2F0ZWdvcnkgPSAnY2VsbC1zdW5rJztcbiAgICBzeW1ib2wgPSAnWCc7XG4gIH0gZWxzZSBpZiAoY2VsbC5oaXQpIHtcbiAgICAvLyBvbmx5IGEgaGl0XG4gICAgY2F0ZWdvcnkgPSAnY2VsbC1oaXQnO1xuICAgIHN5bWJvbCA9ICd4JztcbiAgfSBlbHNlIHtcbiAgICAvLyBhIHNoaXAgdGhhdCBiZWxvbmdzIHRvIHRoZSBwbGF5ZXJcbiAgICBjYXRlZ29yeSA9ICdjZWxsLXNoaXAnO1xuICAgIHN5bWJvbCA9ICdUJztcbiAgfVxuICByZXR1cm4geyBzeW1ib2wsIGNhdGVnb3J5IH07XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUJvYXJkRWxlbShib2FyZCwgaXNPd25Cb2FyZCA9IGZhbHNlLCBwdWJzdWIpIHtcbiAgY29uc3QgcGFyZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNvbnN0IHRhYmxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGFibGUnKTtcbiAgcGFyZW50LmFwcGVuZENoaWxkKHRhYmxlKTtcbiAgY29uc3Qgd2lkdGggPSBib2FyZC5nZXRXaWR0aCgpO1xuICBjb25zdCBoZWlnaHQgPSBib2FyZC5nZXRIZWlnaHQoKTtcblxuICBmb3IgKGxldCByb3cgPSAwOyByb3cgPCBoZWlnaHQ7IHJvdyArPSAxKSB7XG4gICAgY29uc3QgdFJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RyJyk7XG4gICAgdGFibGUuYXBwZW5kQ2hpbGQodFJvdyk7XG4gICAgZm9yIChsZXQgY29sID0gMDsgY29sIDwgd2lkdGg7IGNvbCArPSAxKSB7XG4gICAgICBjb25zdCB0RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICAgIHRSb3cuYXBwZW5kQ2hpbGQodERpdik7XG4gICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTtcbiAgICAgIHREaXYuYXBwZW5kKGJ1dHRvbik7XG4gICAgICBjb25zdCBncm91cCA9IGdldFRpbGVHcm91cChib2FyZC5nZXRUaWxlKHJvdywgY29sKSwgaXNPd25Cb2FyZCk7XG4gICAgICBidXR0b24uY2xhc3NOYW1lID0gZ3JvdXAuY2F0ZWdvcnk7XG4gICAgICBidXR0b24uaW5uZXJUZXh0ID0gZ3JvdXAuc3ltYm9sO1xuICAgICAgLy8gYWRkIGV2ZW50IGxpc3RlbmVyIHRvIGNlbGwgZm9yIGlucHV0c1xuICAgICAgaWYgKCFpc093bkJvYXJkICYmIHB1YnN1Yikge1xuICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgcHVic3ViLmVtaXQoJ3RhcmdldC1zZWxlY3QnLCBbcm93LCBjb2xdKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBwYXJlbnQ7XG59XG5cbmZ1bmN0aW9uIGRyYXdCb2FyZChjb250YWluZXIsIGJvYXJkLCBpc093bkJvYXJkLCBwdWJzdWIpIHtcbiAgY29uc3QgYm9hcmRFbGVtID0gY3JlYXRlQm9hcmRFbGVtKGJvYXJkLCBpc093bkJvYXJkLCBwdWJzdWIpO1xuICBpZiAoY29udGFpbmVyLmZpcnN0Q2hpbGQpIHsgY29udGFpbmVyLnJlcGxhY2VDaGlsZChib2FyZEVsZW0sIGNvbnRhaW5lci5maXJzdENoaWxkKTsgfSBlbHNlIHsgY29udGFpbmVyLmFwcGVuZENoaWxkKGJvYXJkRWxlbSk7IH1cbn1cblxuZnVuY3Rpb24gY3JlYXRlRXZlbnRMb2dFbGVtKGFjdGlvbiwgcGxheWVyKSB7XG4gIGNvbnN0IGxvZ0VsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGxvZ0VsZW0uaW5uZXJUZXh0ID0gYCR7cGxheWVyfSB0YXJnZXRlZCBbJHthY3Rpb24ucm93fSwgJHthY3Rpb24uY29sfV0uYDtcblxuICBpZiAoYWN0aW9uLmhpdCkgeyBsb2dFbGVtLmlubmVyVGV4dCArPSAnIEhpdCEnOyB9XG5cbiAgcmV0dXJuIGxvZ0VsZW07XG59XG5cbmZ1bmN0aW9uIGxvZ0V2ZW50KHBhcmVudCwgYWN0aW9uLCBwbGF5ZXIpIHtcbiAgY29uc3QgZWxlbSA9IGNyZWF0ZUV2ZW50TG9nRWxlbShhY3Rpb24sIHBsYXllcik7XG4gIHBhcmVudC5hcHBlbmRDaGlsZChlbGVtKTtcbn1cblxuZnVuY3Rpb24gbG9nV2lubmVyKHBhcmVudCwgcGxheWVyKSB7XG4gIGNvbnN0IGVsZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIHBhcmVudC5hcHBlbmRDaGlsZChlbGVtKTtcbiAgZWxlbS5pbm5lclRleHQgPSBgJHtwbGF5ZXJ9IFdpbnMhYDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBkcmF3Qm9hcmQsIGxvZ0V2ZW50LCBsb2dXaW5uZXIgfTtcbiIsImltcG9ydCBnYW1lYm9hcmRGYWN0b3J5IGZyb20gJy4vZ2FtZWJvYXJkJztcbmltcG9ydCBwbGF5ZXJGYWN0b3J5IGZyb20gJy4vcGxheWVyJztcbmltcG9ydCBib2FyZERyYXdlciBmcm9tICcuL2RyYXdCb2FyZCc7XG5pbXBvcnQgZXZlbnRFbWl0dGVyIGZyb20gJy4vbWVzc2VuZ2VyJztcblxuZnVuY3Rpb24gc3RhdGljQm9hcmRTZXR1cCgpIHtcbiAgY29uc3QgYm9hcmQgPSBnYW1lYm9hcmRGYWN0b3J5KCk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiAwLCBjb2w6IDIsIGxlbmd0aDogMiwgaXNWZXJ0aWNhbDogZmFsc2UsXG4gIH0pO1xuICBib2FyZC5wbGFjZVNoaXAoe1xuICAgIHJvdzogMywgY29sOiAwLCBsZW5ndGg6IDMsIGlzVmVydGljYWw6IGZhbHNlLFxuICB9KTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDQsIGNvbDogMywgbGVuZ3RoOiAzLCBpc1ZlcnRpY2FsOiB0cnVlLFxuICB9KTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDIsIGNvbDogNSwgbGVuZ3RoOiA0LCBpc1ZlcnRpY2FsOiBmYWxzZSxcbiAgfSk7XG4gIGJvYXJkLnBsYWNlU2hpcCh7XG4gICAgcm93OiA2LCBjb2w6IDUsIGxlbmd0aDogNSwgaXNWZXJ0aWNhbDogZmFsc2UsXG4gIH0pO1xuXG4gIHJldHVybiBib2FyZDtcbn1cblxuZnVuY3Rpb24gcXVpY2tCb2FyZFNldHVwKCkge1xuICBjb25zdCBib2FyZCA9IGdhbWVib2FyZEZhY3RvcnkoKTtcbiAgYm9hcmQucGxhY2VTaGlwKHtcbiAgICByb3c6IDQsIGNvbDogNSwgbGVuZ3RoOiAyLCBpc1ZlcnRpY2FsOiB0cnVlLFxuICB9KTtcblxuICByZXR1cm4gYm9hcmQ7XG59XG5cbmZ1bmN0aW9uIHByb21wdFRhcmdldGluZygpIHtcbiAgY29uc3Qgcm93ID0gcHJvbXB0KCdTZWxlY3QgYSByb3cnKTtcbiAgY29uc3QgY29sID0gcHJvbXB0KCdTZWxlY3QgYSBjb2wnKTtcbiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShbcm93LCBjb2xdKTtcbn1cblxuZnVuY3Rpb24gY2xpY2tUYXJnZXRpbmcocHVic3ViKSB7XG4gIGxldCBldmVudFJlZjtcblxuICAvLyBjcmVhdGUgcHJvbWlzZVxuICBjb25zdCB0YXJnZXRQcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAvLyBjcmVhdGUgZnVuY3Rpb24gdG8gcGFzcyB0byBwdWJzdWJcbiAgICBjb25zdCBnZXRDbGljayA9IChyb3csIGNvbCkgPT4ge1xuICAgICAgcmVzb2x2ZShbcm93LCBjb2xdKTtcbiAgICB9O1xuICAgIGV2ZW50UmVmID0gcHVic3ViLnN1YnNjcmliZSgndGFyZ2V0LXNlbGVjdCcsIGdldENsaWNrKTtcbiAgfSk7XG5cbiAgLy8gdW5zdWJzY3JpYmUgb25jZSBwcm9taXNlIGlzIGRvbmUgYmVpbmcgdXNlZFxuICB0YXJnZXRQcm9taXNlLmZpbmFsbHkoKCkgPT4ge1xuICAgIGV2ZW50UmVmLnVuc3Vic2NyaWJlKCk7XG4gIH0pO1xuXG4gIHJldHVybiB0YXJnZXRQcm9taXNlO1xufVxuXG5hc3luYyBmdW5jdGlvbiBydW5HYW1lKCkge1xuICAvLyBjcmVhdGUgcGxheWVyIDFcbiAgY29uc3QgcGxheWVyMSA9IHBsYXllckZhY3RvcnkoKTtcbiAgLy8gY3JlYXRlIHBsYXllciAyXG4gIGNvbnN0IHBsYXllcjIgPSBwbGF5ZXJGYWN0b3J5KCk7XG4gIC8vIGNyZWF0ZSBib2FyZCAxXG4gIGNvbnN0IGJvYXJkMSA9IHF1aWNrQm9hcmRTZXR1cCgpO1xuICAvLyBjcmVhdGUgYm9hcmQgMlxuICBjb25zdCBib2FyZDIgPSBxdWlja0JvYXJkU2V0dXAoKTtcblxuICBjb25zdCBwdWJzdWIgPSBldmVudEVtaXR0ZXIoKTtcbiAgY29uc3QgbW9kQ2xpY2tUYXJnZXQgPSAoKSA9PiBjbGlja1RhcmdldGluZyhwdWJzdWIpO1xuXG4gIC8vIG9uZSBib2FyZCBjb250YWluZXJcbiAgY29uc3QgY29udGFpbmVyMSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib2FyZDEnKTtcbiAgY29uc3QgY29udGFpbmVyMiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdib2FyZDInKTtcbiAgY29uc3QgZ2FtZUxvZyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsb2cnKTtcbiAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjEsIGJvYXJkMSwgdHJ1ZSk7XG4gIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIsIGZhbHNlLCBwdWJzdWIpO1xuXG4gIC8vIHN0YXJ0IGxvb3BcbiAgd2hpbGUgKCFib2FyZDEuaXNBbGxTdW5rKCkpIHtcbiAgICAvLyBkcmF3IGJvYXJkXG4gICAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjEsIGJvYXJkMSwgdHJ1ZSk7XG4gICAgLy8gYXNrIGh1bWFuIHBsYXllciB0byBjaG9vc2UgdGFyZ2V0XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWF3YWl0LWluLWxvb3BcbiAgICBjb25zdCBhY3Rpb24xID0gYXdhaXQgcGxheWVyMS50YWtlVHVybihib2FyZDIsIG1vZENsaWNrVGFyZ2V0KTtcbiAgICBib2FyZERyYXdlci5sb2dFdmVudChnYW1lTG9nLCBhY3Rpb24xLCAnSHVtYW4nKTtcbiAgICAvLyBhbGxvdyBjbGlja2luZyBvbiBib2FyZFxuICAgIC8vIG9uY2UgdGFyZ2V0IGlzIHNlbGVjdGVkLCBlbmQgY2xpY2tpbmdcblxuICAgIC8vIGNoZWNrIGlmIEFJIGxvc2VzXG4gICAgaWYgKGJvYXJkMi5pc0FsbFN1bmsoKSkge1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIC8vIGRvbid0IHJlZHJhdyBib2FyZFxuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIsIGZhbHNlLCBwdWJzdWIpO1xuICAgIC8vIEFJIGNob29zZSB0YXJnZXRcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYXdhaXQtaW4tbG9vcFxuICAgIGNvbnN0IGFjdGlvbjIgPSBhd2FpdCBwbGF5ZXIyLnRha2VUdXJuKGJvYXJkMSwgcGxheWVyMi5haVRhcmdldCk7XG4gICAgYm9hcmREcmF3ZXIubG9nRXZlbnQoZ2FtZUxvZywgYWN0aW9uMiwgJ0FJJyk7XG4gIC8vIGNoZWNrIGlmIGh1bWFuIGxvc2VzXG4gIC8vIGJhY2sgdG8gdG9wIG9mIGxvb3BcbiAgfVxuICBpZiAoYm9hcmQxLmlzQWxsU3VuaygpKSB7XG4gICAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjEsIGJvYXJkMSwgdHJ1ZSk7XG4gICAgLy8gcmV2ZWFsIEFJJ3MgcmVtYWluaW5nIHNoaXBzXG4gICAgYm9hcmREcmF3ZXIuZHJhd0JvYXJkKGNvbnRhaW5lcjIsIGJvYXJkMiwgdHJ1ZSk7XG4gICAgYm9hcmREcmF3ZXIubG9nV2lubmVyKGdhbWVMb2csICdBSScpO1xuICB9IGVsc2Uge1xuICAgIGJvYXJkRHJhd2VyLmRyYXdCb2FyZChjb250YWluZXIyLCBib2FyZDIsIHRydWUpO1xuICAgIGJvYXJkRHJhd2VyLmxvZ1dpbm5lcihnYW1lTG9nLCAnSHVtYW4nKTtcbiAgfVxuXG4gIC8vIGV4aXQgZnVuY3Rpb25cbn1cblxuZXhwb3J0IGRlZmF1bHQgeyBydW5HYW1lIH07XG4iLCJjb25zdCBldmVudEVtaXR0ZXIgPSAob2xkRXZlbnRMaXN0KSA9PiB7XG4gIGNvbnN0IGV2ZW50cyA9IG9sZEV2ZW50TGlzdCB8fCB7fTtcblxuICBjb25zdCBzdWJzY3JpYmUgPSAoZXZlbnROYW1lLCBjYikgPT4ge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtZXhwcmVzc2lvbnNcbiAgICAoZXZlbnRzW2V2ZW50TmFtZV0gfHwgKGV2ZW50c1tldmVudE5hbWVdID0gW10pKS5wdXNoKGNiKTtcblxuICAgIGNvbnN0IHVuc3Vic2NyaWJlID0gKCkgPT4ge1xuICAgICAgaWYgKGV2ZW50c1tldmVudE5hbWVdKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1iaXR3aXNlXG4gICAgICAgIGV2ZW50c1tldmVudE5hbWVdLnNwbGljZShldmVudHNbZXZlbnROYW1lXS5pbmRleE9mKGNiKSA+Pj4gMCwgMSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIHJldHVybiB7IHVuc3Vic2NyaWJlIH07XG4gIH07XG5cbiAgY29uc3QgZW1pdCA9IChldmVudE5hbWUsIGFyZ3MpID0+IHtcbiAgICAoZXZlbnRzW2V2ZW50TmFtZV0gfHwgW10pLmZvckVhY2goKGZuKSA9PiB7XG4gICAgICBmbiguLi5hcmdzKTtcbiAgICB9KTtcbiAgfTtcblxuICByZXR1cm4geyBzdWJzY3JpYmUsIGVtaXQgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGV2ZW50RW1pdHRlcjtcbiIsImltcG9ydCBnYW1lTG9vcCBmcm9tICcuL2dhbWVMb29wJztcblxuLy8gdGVzdCB0aGF0IHdlYnBhY2sgd29ya3NcbmNvbnNvbGUubG9nKCd3ZWJwYWNrIGNvbXBpbGVkIHRvIG1haW4uanMnKTtcblxuY29uc3Qgd2FpdEZvclBhZ2UgPSBQcm9taXNlLnJlc29sdmUoJ2xvYWRlZCcpO1xud2FpdEZvclBhZ2UudGhlbigoKSA9PiB7XG4gIGdhbWVMb29wLnJ1bkdhbWUoKTtcbn0pO1xuXG5jb25zb2xlLmxvZygnZW5kIG9mIG1haW4uanMnKTtcbiJdLCJuYW1lcyI6WyJib2FyZCIsInNoaXBzIiwiaSIsIkFycmF5IiwiZmlsbCIsImdldFRpbGUiLCJyb3ciLCJjb2wiLCJwbGFjZVNoaXAiLCJsZW5ndGgiLCJpc1ZlcnRpY2FsIiwic2hpcCIsImhpdHMiLCJnZXRMZW5ndGgiLCJpc1N1bmsiLCJldmVyeSIsInZhbHVlIiwiaGl0IiwiaW5kZXgiLCJwdXNoIiwicG9zIiwicmVjZWl2ZUF0dGFjayIsImNlbGwiLCJtaXNzIiwiaXNBbGxTdW5rIiwiaXNWYWxpZFRhcmdldCIsImdldFdpZHRoIiwiZ2V0SGVpZ2h0IiwiaGl0U3RhY2siLCJzZWFyY2hDb3VudCIsInNlYXJjaE9mZnNldHMiLCJyYW5kSW50IiwibnVtIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwicmFuZG9tVGFyZ2V0IiwiUHJvbWlzZSIsInJlc29sdmUiLCJ0YWtlVHVybiIsImFzeW5jIiwib3RoZXJCb2FyZCIsInRhcmdldEZ1bmMiLCJ2YWxpZFRhcmdldCIsImFpVGFyZ2V0IiwicG9wIiwib2Zmc2V0IiwiZ2V0VGlsZUdyb3VwIiwiaXNPd25Cb2FyZCIsInN5bWJvbCIsImNhdGVnb3J5IiwiY29udGFpbmVyIiwicHVic3ViIiwiYm9hcmRFbGVtIiwicGFyZW50IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50IiwidGFibGUiLCJhcHBlbmRDaGlsZCIsIndpZHRoIiwiaGVpZ2h0IiwidFJvdyIsInREaXYiLCJidXR0b24iLCJhcHBlbmQiLCJncm91cCIsImNsYXNzTmFtZSIsImlubmVyVGV4dCIsImFkZEV2ZW50TGlzdGVuZXIiLCJlbWl0IiwiY3JlYXRlQm9hcmRFbGVtIiwiZmlyc3RDaGlsZCIsInJlcGxhY2VDaGlsZCIsImFjdGlvbiIsInBsYXllciIsImVsZW0iLCJsb2dFbGVtIiwiY3JlYXRlRXZlbnRMb2dFbGVtIiwicXVpY2tCb2FyZFNldHVwIiwiZ2FtZWJvYXJkIiwicGxheWVyMSIsInBsYXllcjIiLCJib2FyZDEiLCJib2FyZDIiLCJvbGRFdmVudExpc3QiLCJldmVudHMiLCJzdWJzY3JpYmUiLCJldmVudE5hbWUiLCJjYiIsInVuc3Vic2NyaWJlIiwic3BsaWNlIiwiaW5kZXhPZiIsImFyZ3MiLCJmb3JFYWNoIiwiZm4iLCJtb2RDbGlja1RhcmdldCIsImV2ZW50UmVmIiwidGFyZ2V0UHJvbWlzZSIsImZpbmFsbHkiLCJjbGlja1RhcmdldGluZyIsImNvbnRhaW5lcjEiLCJnZXRFbGVtZW50QnlJZCIsImNvbnRhaW5lcjIiLCJnYW1lTG9nIiwiYWN0aW9uMSIsImFjdGlvbjIiLCJjb25zb2xlIiwibG9nIiwidGhlbiIsImdhbWVMb29wIl0sInNvdXJjZVJvb3QiOiIifQ==